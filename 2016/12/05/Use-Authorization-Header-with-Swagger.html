<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>Use Authorization Header with Swagger</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://mimiz.github.io/favicon.ico">

    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic|Open+Sans:400italic,700italic,700,400">
    <link rel="stylesheet" type="text/css" href="//mimiz.github.io/themes/roon/assets/css/screen.css?v=1480914598252" />

    <link rel="canonical" href="https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html" />
    <meta name="referrer" content="origin" />
    
    <meta property="og:site_name" content="Rémi&#x27;s Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Use Authorization Header with Swagger" />
    <meta property="og:description" content="Recently, on a project I had to document an API using Swagger, as an authentication mechanism, the API, is using JWT. The Token needs to be set in the Authorization Header of the HTTP request as this : Authorization Bearer: JWT-token As we wanted to use the Swagger UI to allow" />
    <meta property="og:url" content="https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html" />
    <meta property="article:tag" content="Swagger" />
    <meta property="article:tag" content=" Authorization" />
    <meta property="article:tag" content=" Bearer" />
    <meta property="article:tag" content=" API" />
    <meta property="article:tag" content=" Express" />
    <meta property="article:tag" content=" JWT" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Use Authorization Header with Swagger" />
    <meta name="twitter:description" content="Recently, on a project I had to document an API using Swagger, as an authentication mechanism, the API, is using JWT. The Token needs to be set in the Authorization Header of the HTTP request as this : Authorization Bearer: JWT-token As we wanted to use the Swagger UI to allow" />
    <meta name="twitter:url" content="https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html" />
    
    <script type="application/ld+json">
null
    </script>

    <meta name="generator" content="HubPress" />
    <link rel="alternate" type="application/rss+xml" title="Rémi&#x27;s Blog" href="https://mimiz.github.io/rss/" />
</head>
<body class="post-template tag-Swagger tag-Authorization tag-Bearer tag-API tag-Express tag-JWT  noimage">

    


    <article role="main" class="">
        <header>
            <a href="https://mimiz.github.io" id="home_link">«</a>
            <div class="meta"><time datetime="2016-12-05"><a href="https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html">December 05, 2016</a></time> <span class="count" id="js-reading-time"></span></div>
            <h1>Use Authorization Header with Swagger</h1>
        </header>

        <div class="text" id="js-post-content">
            <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Recently, on a project I had to document an API using <a href="http://swagger.io/">Swagger</a>, as an authentication mechanism, the API, is using JWT.</p>
</div>
<div class="paragraph">
<p>The Token needs to be set in the <code>Authorization</code> Header of the HTTP request as this :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Authorization Bearer: JWT-token</code></pre>
</div>
</div>
<div class="paragraph">
<p>As we wanted to use the <a href="http://swagger.io/swagger-ui/">Swagger UI</a> to allow clients to test requests and responses of the API.</p>
</div>
<div class="paragraph">
<p>To define the API, we use  the <a href="http://swagger.io/swagger-editor/">Swagger Editor</a> Online.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_start_the_documentation_and_the_login_route">Start the Documentation and the /login route</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First we need to create the main API description :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">swagger: '2.0'
info:
 version: 0.0.1
 title: MY-SUPERB-API
host: '127.0.0.1:4000'
schemes:
 - http
 - https
produces:
 - application/json
paths:
 /login:
  post:
   tags:
    - auth
   description: |
    Allow users to log in, and to receive a Token
   parameters:
    -
     in: body
     name: body
     description: The email/password
     required: true
     schema:
      $ref: '#/definitions/Login'
   responses:
    '200':
     description: Login Success
     schema:
      $ref: '#/definitions/Token'
    '400':
     description: Whether the user is not found or error while login
     schema:
      $ref: '#/definitions/Error'
    '403':
     description: &gt;-
      If user is not found (bad credentials) OR if user can not login (a
      concierge of an unsctive client)
     schema:
      $ref: '#/definitions/Error'
definitions:
 Login:
  type: object
  properties:
   email:
    type: string
   password:
    type: string
 Token:
  type: object
  properties:
   token:
    type: string
 Error:
  type: object
  properties:
   message:
    type: string
   error:
    type: string</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will define the <code>/login</code> route that receive a <code>POST</code> HTTP request with email and password, if they matches your credential provider the route will return a <code>Token</code> response :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
  "token":"JWT TOKEN"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_describe_the_security_definition">Describe the Security Definition</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now we should define create a <strong>securityDefinitions</strong>, this will describe how authorization is made, and allow the <a href="http://swagger.io/swagger-ui/">Swagger UI</a> to ask for a token when needed.</p>
</div>
<div class="paragraph">
<p>So first edit the API definition :</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">swagger: '2.0'
info:
 version: 0.0.1
 title: MY-SUPERB-API
host: '127.0.0.1:4000'
schemes:
 - http
 - https
produces:
 - application/json
securityDefinitions: <i class="conum" data-value="1"></i><b>(1)</b>
 Bearer:
  description: |
   For accessing the API a valid JWT token must be passed in all the queries in
   the 'Authorization' header.


   A valid JWT token is generated by the API and retourned as answer of a call
   to the route /login giving a valid user &amp; password.


   The following syntax must be used in the 'Authorization' header :

       Bearer: xxxxxx.yyyyyyy.zzzzzz
  type: apiKey
  name: Authorization
  in: header
paths:
 /login:
  post:
   tags:
    - auth
   description: |
    Allow users to log in, and to receive a Token
   parameters:
    -
     in: body
     name: body
     description: The email/password
     required: true
     schema:
      $ref: '#/definitions/Login'
   responses:
    '200':
     description: Login Success
     schema:
      $ref: '#/definitions/Token'
    '400':
     description: Whether the user is not found or error while login
     schema:
      $ref: '#/definitions/Error'
    '403':
     description: &gt;-
      If user is not found (bad credentials) OR if user can not login (a
      concierge of an unsctive client)
     schema:
      $ref: '#/definitions/Error'
definitions:
 Login:
  type: object
  properties:
   email:
    type: string
   password:
    type: string
 Token:
  type: object
  properties:
   token:
    type: string
 Error:
  type: object
  properties:
   message:
    type: string
   error:
    type: string</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Ajout de la clé <strong>securityDefinitions</strong></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The description is, I think, self described, so you can understand it</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_create_a_protected_route">Create a protected route</h2>
<div class="sectionbody">
<div class="paragraph">
<p>And now you can define a route <code>/users</code> for example that needs the user to send a valid Authorization header  &#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">swagger: '2.0'
info:
 version: 0.0.1
 title: MY-SUPERB-API
host: '127.0.0.1:4000'
schemes:
 - http
 - https
produces:
 - application/json
securityDefinitions:
 Bearer:
  description: |
   For accessing the API a valid JWT token must be passed in all the queries in
   the 'Authorization' header.


   A valid JWT token is generated by the API and retourned as answer of a call
   to the route /login giving a valid user &amp; password.


   The following syntax must be used in the 'Authorization' header :

       Bearer: xxxxxx.yyyyyyy.zzzzzz
  type: apiKey
  name: Authorization
  in: header
paths:
 /login:
  post:
   tags:
    - auth
   description: |
    Allow users to log in, and to receive a Token
   parameters:
    -
     in: body
     name: body
     description: The email/password
     required: true
     schema:
      $ref: '#/definitions/Login'
   responses:
    '200':
     description: Login Success
     schema:
      $ref: '#/definitions/Token'
    '400':
     description: Whether the user is not found or error while login
     schema:
      $ref: '#/definitions/Error'
    '403':
     description: &gt;-
      If user is not found (bad credentials) OR if user can not login (a
      concierge of an unsctive client)
     schema:
      $ref: '#/definitions/Error'
 /users:
  get:
   tags:
    - users
   security:
    - Bearer: []
   description: Get a list of all existing users
   responses:
    '200':
     description: An array of users
     schema:
      type: array
      items:
       $ref: '#/definitions/User'
definitions:
 Login:
  type: object
  properties:
   email:
    type: string
   password:
    type: string
 Token:
  type: object
  properties:
   token:
    type: string
 Error:
  type: object
  properties:
   message:
    type: string
   error:
    type: string
 User:
    type: object
    properties:
     email:
      type: string
     password:
      type: string
     firstName:
      type: string
     lastName:
      type: string
     lastLogin:
      type: string
      format: date</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you just described that the <code>/users</code> route need the Bearer authentication &#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_use_swagger_ui">Use Swagger UI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to use the Swagger UI, you should be aware that the <strong>host</strong> value is defined on <em>'127.0.0.1:4000'</em> and this may be changed in your case !</p>
</div>
<div class="sect2">
<h3 id="_first_login_and_get_the_token">First Login and get the token</h3>
<div class="paragraph">
<p>The now you can use the <a href="http://swagger.io/swagger-ui/">Swagger UI</a> (with the editor) to login :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-1.png" alt="swagger auth 1.png">
</div>
</div>
<div class="paragraph">
<p>And the response should be :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-2.png" alt="swagger auth 2.png">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_authenticate_the_editor">Authenticate the editor :</h3>
<div class="paragraph">
<p>Now at the top of the generated documentation you can click the <strong>Authenticate</strong> Button :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-3.png" alt="swagger auth 3.png">
</div>
</div>
<div class="paragraph">
<p>Then fill with the Token you received at the previous step :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-4.png" alt="swagger auth 4.png">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We are spcifying the <strong>Bearer:</strong> keyword.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_try_the_protected_route">Try the protected route</h3>
<div class="paragraph">
<p>Now in the section of the protected route : <code>/users</code> you can check the <em>Bearer</em> checkbox and try the operation :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-5.png" alt="swagger auth 5.png">
</div>
</div>
<div class="paragraph">
<p>You should have a valid answer :</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://mimiz.github.io/images/swagger-auth-6.png" alt="swagger auth 6.png">
</div>
</div>
<div class="paragraph">
<p>Now you can add your other routes to finish defined your API.</p>
</div>
<div class="paragraph">
<p>Have fun !</p>
</div>
</div>
</div>
</div>
        </div>

        <menu>
            <a href="" id="btn_share" class="btn" title="Share">
                <span aria-hidden="true" data-icon="S"></span>
                <strong>Share</strong>
            </a>
            <a href="http://twitter.com/share?text=Use%20Authorization%20Header%20with%20Swagger&url=https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" id="btn_comment" class="btn" target="_blank">
                <span aria-hidden="true" data-icon="C"></span> Comment on Twitter
            </a>
        </menu>


        <footer class="post-footer" role="contentinfo">

            <div class="vcard">
                <a href="https://mimiz.github.io/rss" id="btn_feed" class="btn" title="Feed" target="_blank">
                    <span aria-hidden="true" data-icon=")"></span>
                    <strong>Feed</strong>
                </a>

                <a href="https://mimiz.github.io/author/mimiz/" class="photo">
                    <span style="background-image: url('https://avatars.githubusercontent.com/u/377238?v&#x3D;3');">
                        <img src="https://avatars.githubusercontent.com/u/377238?v&#x3D;3" alt="mimiz33">
                    </span>
                </a>

                <div class="details">
                    <h4><a href="https://mimiz.github.io/author/mimiz/" class="url n">mimiz33</a></h4>
                    
                    <a href="http://www.mimiz.fr" class="js-remove-domain-schema">http://www.mimiz.fr</a>
                </div>
            </div>

            <div id="user_bio">
                <div class="inner">
                    
                </div>
            </div>

        </footer>




    </article>

    <div id="share_modal">
        <div class="wrap">
            <div class="inner">
                <header>
                    Share
                    <a href="" class="close" title="Close">&times;</a>
                </header>

                <div class="roon-share-links">
                    <a href="https://twitter.com/share" class="twitter-share-button" data-dnt="true">Tweet</a>
                    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

                    <div id="fb-elems">
                        <div id="fb-root"></div>
                        <script>(function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0];
                        if (d.getElementById(id)) return;
                        js = d.createElement(s); js.id = id;
                        js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=463438580397968";
                        fjs.parentNode.insertBefore(js, fjs);
                        }(document, 'script', 'facebook-jssdk'));</script>
                        <div class="fb-like" data-send="false" data-layout="button_count" data-width="110" data-show-faces="false" data-font="arial"></div>
                    </div>

                    <div id="pinit-btn">
                        <a href="//pinterest.com/pin/create/button/?url=https://mimiz.github.io/2016/12/05/Use-Authorization-Header-with-Swagger.html&amp;description=Use%20Authorization%20Header%20with%20Swagger-R%C3%A9mi's%20Blog " data-pin-do="buttonPin" data-pin-config="beside"><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png"></a>
                        <script type="text/javascript" src="//assets.pinterest.com/js/pinit.js"></script>
                    </div>
                </div>
            </div>
        </div>
    </div>






    <script>

            function get_text(el) {
                ret = "";
                var length = el.childNodes.length;
                for(var i = 0; i < length; i++) {
                    var node = el.childNodes[i];
                    if(node.nodeType != 8) {
                        ret += node.nodeType != 1 ? node.nodeValue : get_text(node);
                    }
                }
                return ret;
            }
            function reading_time () {
                var post_content = document.getElementById('js-post-content');
                if (post_content) {
                    var words = get_text(post_content),
                        count = words.split(/\s+/).length,
                        read_time = Math.ceil((count / 150)),
                        read_time_node = document.createTextNode(read_time + ' min read');
                    document.getElementById('js-reading-time').appendChild(read_time_node);
                }
            }

        function no_schema_links () {
            var links = document.querySelectorAll('.js-remove-domain-schema');
            if (links) {
                for (i = 0; i < links.length; ++i) {
                    var link = links[i],
                        text = link.innerHTML,
                        no_schema = text.replace(/.*?:\/\//g, "");
                    link.innerHTML = no_schema;
                }
            }
        }

        window.onload = function () {
            no_schema_links();

            reading_time();
        }
    </script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.9.0/moment-with-locales.min.js?v="></script> <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js?v="></script> 
      <script type="text/javascript">
        jQuery( document ).ready(function() {
          // change date with ago
          jQuery('ago.ago').each(function(){
            var element = jQuery(this).parent();
            element.html( moment(element.text()).fromNow());
          });
        });

        hljs.initHighlightingOnLoad();
      </script>

        <script>
            $(function(){
                var share_modal = $("#share_modal"),
                    update_social_links = true;

                $("#btn_share").click(function(){
                    var that = $(this);
                    share_modal.fadeIn(200);
                    return false;
                });

                share_modal.click(function(e){
                    if (e.target.className == "wrap" || e.target.id == "share_modal") {
                        share_modal.fadeOut(200);
                    }
                    return false;
                });

                share_modal.find("div.inner > header > a.close").click(function(){
                    share_modal.fadeOut(200);
                    return false;
                });
            });
        </script>


    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-18243278-5', 'auto');
    ga('send', 'pageview');

    </script>

</body>
</html>
